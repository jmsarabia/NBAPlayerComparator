<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>NBA Player Comparator</title>
    <style type="text/css">

div.tooltip { 
    position: absolute;     
    text-align: center;     
    width: 200px;          
    height: 80px;         
    padding: 4px;       
    font: 12px sans-serif;    
    background: cornflowerblue; 
    border: 0px;    
    border-radius: 8px;     
    pointer-events: none;     
}

    </style>
  </head>
<body>
<img src="logo.png" alt="logo" width="500" height="150">

<script src="https://d3js.org/d3.v4.min.js"></script>
      
<script type="text/javascript">

var allplayers = [];
var playoffsArr = [];

var teammap = {"BUF": "Buffalo Braves", "IND": "Indiana Pacers", 
"LAL": "Los Angeles Lakers", "UTA": "Utah Jazz", "DET": "Detroit Pistons",
"DAL": "Dallas Mavericks", "MIL": "Milwaukee Bucks", "DEN": "Denver Nuggets", "DEV": "Denver Nuggets",
"PHI": "Philadelphia 76ers", "MEM": "Memphis Grizzlies", "GSW": "Golden State Warriors", 
"WAS": "Washington Wizards", "CLE": "Cleveland Cavaliers", "LAC": "Los Angeles Clippers",
"NYK": "New York Knicks", "BOS": "Boston Celtics", "NJN": "New Jersey Nets",
"MLH": "Milwaukee Hawks", "STL": "St. Louis Hawks", "TOT": "Multiple teams",
"PHO": "Phoenix Suns", "HOU": "Houston Rockets", "POR": "Portland Trailblazers",
"SEA": "Seattle SuperSonics", "SAS": "San Antonio Spurs", "CHH": "Charlotte Hornets",
"ATL": "Atlanta Hawks", "ORL": "Orlando Magic", "MIA": "Miami Heat", "CHI": "Chicago Bulls",
"KCK": "Kansas City Kings", "SAC": "Sacramento Kings", "MNL": "Minneapolis Lakers",
"SDR": "San Diego Rockets", "BAL": "Baltimore Bullets", "CAP": "Capital Bullets",
"WSB": "Washington Bullets", "TOR": "Toronto Raptors", "SYR": "Syracuse Nationals",
"BRK": "Brooklyn Nets", "MIN": "Minnesota Timberwolves", "CIN": "Cincinnati Royals",
"SDC": "San Diego Clippers", "CHP": "Chicago Packers", "CHZ": "Chicago Zephyrs",
"NOJ": "New Orleans Jazz", "PHW": "Philadelphia Warriors", "OKC": "Oklahoma City Thunder",
"NOK": "New Orleans Hornets", "NOH": "New Orleans Hornets"};

var moreplayers = ["Kevin Durant", "James Harden", "Stephen Curry", "Russell Westbrook", 
"Chris Paul", "Chris Webber", "Chris Bosh", "Dwight Howard", "Isiah Thomas",
"Jamal Crawford", "Jason Kidd", "Jason Terry", "Mike Bibby", "Rudy Gay",
"Scottie Pippen", "Steve Nash", "Tony Parker", "Paul George", "Bob Lanier",
"Bob McAdoo", "Clifford Robinson", "Walter Davis"];


function alreadyExists(name) {
  for(t = 0 ; t < allplayers.length ; t++) {
    if(allplayers[t].name == name) {
      return t;
    }
  }
  return -1;
}

function getBestPlayers() {
  var bestplayers = [];
  for(r = 0 ; r < allplayers.length ; r++) {
    seasons_arr = allplayers[r].seasons;
    var total_points = 0;
    for(e = 0 ; e < seasons_arr.length ; e++) {
      total_points += seasons_arr[e].points;
    }
    if(total_points > 20000) {
      // console.log(allplayers[r].name);
      bestplayers.push(allplayers[r]);
    }
    if(moreplayers.includes(allplayers[r].name.replace("*", ""))) {
      bestplayers.push(allplayers[r]);
    }
  }
  return bestplayers;
}

function formatName(name) {
  var string = name.replace(" ", "");
  string += ".png";
  return string;
}

function debugging1(bestplayers) {
  for(q = 0 ; q < bestplayers.length ; q++) {
    if(bestplayers[q].name.replace("*", "") == "Chris Paul") {
      console.log(bestplayers[q].name);
      for(e = 0 ; e < bestplayers[q].seasons.length ; e++) {
        console.log(bestplayers[q].seasons[e].year);
        console.log(bestplayers[q].seasons[e].playoffs);
        if(bestplayers[q].seasons[e].team.length > 1) {
          for(w = 0 ; w < bestplayers[q].seasons[e].team.length ; w++) {
            console.log(bestplayers[q].seasons[e].team[w]);
          }
        } else {
          console.log(bestplayers[q].seasons[e].team[0]);
        }
      }
    }
  // console.log("LENGTH: " + bestplayers.length);
  }
}

function debugging2() {
  for(q = 0 ; q < playoffsArr.length ; q++) {
    console.log(playoffsArr[q].playoffYear);
    for(w = playoffsArr[q].results.length - 1 ; w >= 0 ; w--) {
      if(playoffsArr[q].results[w].series == "Finals") {
        console.log("Champion: " + playoffsArr[q].results[w].winner);
        console.log("Finalist: " + playoffsArr[q].results[w].loser);
      } else {
        console.log(playoffsArr[q].results[w].loser + " lost in " + playoffsArr[q].results[w].series);
      }
    }
  }
  console.log("LENGTH: " + bestplayers.length);
}

function yearAdded(index, year) {
  for(s = 0 ; s < allplayers[index].seasons.length ; s++) {
    if(allplayers[index].seasons[s].year == year) {
      return s;
    }
  }
  return -1;
}

function getIndex(player, bestplayers) {
  for(g = 0 ; g < bestplayers.length ; g++) {
    if(bestplayers[g].name.replace("*", "") == player) {
      return g;
    }
  }
}

function yearExists(year) {
  for(r = 0 ; r < playoffsArr.length ; r++) {
    if(playoffsArr[r].playoffYear == year) {
      return r;
    }
  }
  return -1;
}

function setPlayoffs(bestplayers) {
  for(p = 0 ; p < bestplayers.length ; p++) {
    for(y = 0 ; y < bestplayers[p].seasons.length ; y++) {
      var numberteams = bestplayers[p].seasons[y].team.length;
      if(numberteams == 1) {
        var teamName = getTeamName(bestplayers[p].seasons[y].team[0]);
      } else {
        var teamName = getTeamName(bestplayers[p].seasons[y].team[numberteams - 1]);
      }
      var year = bestplayers[p].seasons[y].year;
      var playoffsResult = checkPlayoffs(teamName, year);
      bestplayers[p].seasons[y].playoffs = playoffsResult;
    }
  }
}

function checkPlayoffs(team, year) {
  var index = yearExists(year);
  if(index != -1) {
    resultsArray = playoffsArr[index].results;
    for(s = resultsArray.length - 1 ; s >= 0 ; s--) {
      if(resultsArray[s].winner.startsWith(team) && resultsArray[s].series == "Finals") {
        return ["Champion", resultsArray[s].winner, resultsArray[s].loser, resultsArray[s].gW, resultsArray[s].gL];
      }
      if(resultsArray[s].loser.startsWith(team) && resultsArray[s].series == "Finals") {
        return ["Finals", resultsArray[s].winner, resultsArray[s].loser, resultsArray[s].gW, resultsArray[s].gL];
      }
      if(resultsArray[s].loser.startsWith(team) && resultsArray[s].series != "Finals") {
        return [resultsArray[s].series, resultsArray[s].winner, resultsArray[s].loser, resultsArray[s].gW, resultsArray[s].gL];
      }
    }
  }
  return ["No Playoffs"];
}

function getTeamName(team) {
  return teammap[team];
}

//setting up the margins
var margin = {top: 50, right: 50, bottom: 50, left: 50},
width = 960 - margin.left - margin.right,
height = 1400 - margin.top - margin.bottom;

var div = d3.select("body").append("div") 
    .attr("class", "tooltip")       
    .style("opacity", 0);

//adding svg to page
var svg = d3.select("body").append("svg")
  .attr("width", width + margin.left + margin.right)
  .attr("height", height + margin.top + margin.bottom)
  .append("g")
  .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

d3.csv("playoffs.csv", function(data) {
  data.forEach(function(d) {
    var year = +d.Yr;
    var index = yearExists(year);

    if(d.Lg == "NBA" && !d.Series.includes("Tiebreak")) {

      if(index == -1) {
        var playoffRound = {playoffYear: year, results: []};
        var result = {series: d.Series, loser: d.TeamL, winner: d.TeamW, gW: +d.GamesW, gL: +d.GamesL};
        playoffRound.results.push(result);
        playoffsArr.push(playoffRound);

      } else {

        var result = {series: d.Series, loser: d.TeamL, winner: d.TeamW, gW: +d.GamesW, gL: +d.GamesL};
        playoffsArr[index].results.push(result);
      }
    }
  });
});


//reading in player data
d3.csv("seasonstats.csv", function(data) {
  data.forEach(function(d) {
    var name = d.Player;
    var index = alreadyExists(name);

    if(index == -1) {

      var season = {year: +d.Year, points: +d.PTS, assists: +d.AST,
        rebounds: +d.TRB, steals: +d.STL, blocks: +d.BLK,
        plusminus: +d.BPM, games: +d.G, position: d.Pos, team: [d.Tm],
        age: +d.Age, minutes: +d.MP, threepointers: +d.THREEP,
        fieldgoalpercent: +d.FGPERC, threepointerpercent: +d.THREEPPERC,
        playoffs: null};

      var player = {name: d.Player, seasons: []};
      player.seasons.push(season);
      
      allplayers.push(player);

    } else {

      var yearIndex = yearAdded(index, +d.Year);

      if(yearIndex == -1) {

        var season = {year: +d.Year, points: +d.PTS, assists: +d.AST,
          rebounds: +d.TRB, steals: +d.STL, blocks: +d.BLK,
          plusminus: +d.BPM, games: +d.G, position: d.Pos, team: [d.Tm],
          age: +d.Age, minutes: +d.MP, threepointers: +d.THREEP,
          fieldgoalpercent: +d.FGPERC, threepointerpercent: +d.THREEPPERC,
          playoffs: null};

          allplayers[index].seasons.push(season);

      } else {

        allplayers[index].seasons[yearIndex].team.push(d.Tm);

      }

    }
  });

  bestplayers = getBestPlayers();
  setPlayoffs(bestplayers);

  bestplayers.sort(function(a,b) {
    var x = a.name.toLowerCase();
    var y = b.name.toLowerCase();
    return x < y ? -1 : x > y ? 1 : 0;
});

  // debugging1(bestplayers);
  // debugging2();

  var select1 = d3.select('body')
    .append('select')
    .attr('class','select')
    .attr('id', 'one')
    .style('position', 'absolute')
    .style('top', '205px')
    .style('left', '20px')
    .on('change',onchange1)

  var options1 = select1
    .selectAll('option')
    .data(bestplayers).enter()
    .append('option')
    .text(function (d, i) { return d.name.replace("*", ""); })

  var select2 = d3.select('body')
    .append('select')
    .attr('class','select')
    .attr('id', 'two')
    .style('position', 'absolute')
    .style('top', '235px')
    .style('left', '20px')
    .on('change',onchange2);

  var options2 = select2
    .selectAll('option')
    .data(bestplayers).enter()
    .append('option')
    .text(function (d) { return d.name.replace("*", ""); })

  var selection1 = document.getElementById('one');
  var index1 = getIndex("LeBron James", bestplayers);
  selection1.selectedIndex = index1;

  var selection2 = document.getElementById('two');
  var index2 = getIndex("Michael Jordan", bestplayers);
  selection2.selectedIndex = index2;

  svg.append("rect")
    .attr("x", -50)
    .attr("y", -50)
    .attr("width", 175)
    .attr("height", 100)       // set the x corner curve radius
    .attr("ry", 10)
    .style("fill", "CornflowerBlue");

  svg.append("text")             
    .attr("transform",
          "translate(35, -22)")
    .style("text-anchor", "middle")
    .style("font-size", "19px")
    .text("Player Filter")
    .style("font-family", "Helvetica, Arial, Sans-Serif")
    .attr("fill", "white");

  svg.append("text")             
    .attr("transform",
          "translate(350, 270)")
    .style("text-anchor", "middle")
    .style("font-size", "20px")
    .text("Average Stats for Each Season")
    .style("font-family", "Helvetica, Arial, Sans-Serif")
    .attr("fill", "black");

  d3.selectAll("svg")
    .append("image")
    .attr("xlink:href", "playerpictures/" + formatName(d3.select('select#one').property('value')))
    .attr("class", "pico")
    .attr("id", "pic_one")
    .attr("height", 240)
    .attr("width", 400)
    .attr("x", 100)
    .attr("y", 0);

  svg.append("text")             
    .attr("transform",
        "translate(250, 210)")
    .attr("id", "text_one")
    .style("text-anchor", "middle")
    .style("font-family", "Helvetica, Arial, Sans-Serif")
    .style("font-size", "14px")
    .text(function() {
      return d3.select('select#one').property('value');
    })
    .attr("fill", "black");

  d3.selectAll("svg")
    .append("image")
    .attr("xlink:href", "playerpictures/" + formatName(d3.select('select#two').property('value')))
    .attr("class", "pico")
    .attr("id", "pic_two")
    .attr("height", 240)
    .attr("width", 400)
    .attr("x", 340)
    .attr("y", 0);

  svg.append("text")             
    .attr("transform",
        "translate(480, 210)")
    .attr("id", "text_two")
    .style("text-anchor", "middle")
    .style("font-family", "Helvetica, Arial, Sans-Serif")
    .style("font-size", "14px")
    .text(function() {
      return d3.select('select#two').property('value');
    })
    .attr("fill", "black");

  var index3 = getIndex(d3.select('select#one').property('value'), bestplayers);
  var index4 = getIndex(d3.select('select#two').property('value'), bestplayers);

  function getMinPL(seasonArr1, seasonArr2) {
    var min = 0;
    for(t = 0 ; t < seasonArr1.length ; t++) {
      var plusminus = seasonArr1[t].plusminus;
      if(plusminus < min) {
        min = plusminus;
      }
    }
    for(w = 0 ; w < seasonArr2.length ; w++) {
      var plusminus = seasonArr2[w].plusminus;
      if(plusminus < min) {
        min = plusminus;
      }
    }
    return min;
  }

  function getMax(which, seasonArr1, seasonArr2) {
    var max = 0;
    for(q = 0 ; q < seasonArr1.length ; q++) {
      var games = seasonArr1[q].games;
      if(which == 0) {
        var ppg = seasonArr1[q].points/games;
        if(ppg > max) {
          max = ppg;
        }
      }
      if(which == 1) {
        var apg = seasonArr1[q].assists/games;
        if(apg > max) {
          max = apg;
        }
      }
      if(which == 2) {
        var rpg = seasonArr1[q].rebounds/games;
        if(rpg > max) {
          max = rpg;
        }
      }
      if(which == 3) {
        var bpg = seasonArr1[q].blocks/games;
        if(bpg > max) {
          max = bpg;
        }
      }
      if(which == 4) {
        var spg = seasonArr1[q].steals/games;
        if(spg > max) {
          max = spg;
        }
      }
      if(which == 5) {
        var plusminus = seasonArr1[q].plusminus;
        if(plusminus > max) {
          max = plusminus;
        }
      }
    }
    for(e = 0 ; e < seasonArr2.length ; e++) {
      var games = seasonArr2[e].games;
      if(which == 0) {
        var ppg = seasonArr2[e].points/games;
        if(ppg > max) {
          max = ppg;
        }
      }
      if(which == 1) {
        var apg = seasonArr2[e].assists/games;
        if(apg > max) {
          max = apg;
        }
      }
      if(which == 2) {
        var rpg = seasonArr2[e].rebounds/games;
        if(rpg > max) {
          max = rpg;
        }
      }
      if(which == 3) {
        var bpg = seasonArr2[e].blocks/games;
        if(bpg > max) {
          max = bpg;
        }
      }
      if(which == 4) {
        var spg = seasonArr2[e].steals/games;
        if(spg > max) {
          max = spg;
        }
      }
      if(which == 5) {
        var plusminus = seasonArr2[e].plusminus;
        if(plusminus > max) {
          max = plusminus;
        }
      }
    }
    return max;
  }

  var maxPPG = getMax(0, bestplayers[index3].seasons, bestplayers[index4].seasons);
  var maxAPG = getMax(1, bestplayers[index3].seasons, bestplayers[index4].seasons);
  var maxRPG = getMax(2, bestplayers[index3].seasons, bestplayers[index4].seasons);
  var maxBPG = getMax(3, bestplayers[index3].seasons, bestplayers[index4].seasons);
  var maxSPG = getMax(4, bestplayers[index3].seasons, bestplayers[index4].seasons);
  var maxPL = getMax(5, bestplayers[index3].seasons, bestplayers[index4].seasons);
  var minPL = getMinPL(bestplayers[index3].seasons, bestplayers[index4].seasons);

  function getPPGScale(maxPPG) {
    var ppgScale = d3.scaleLinear().domain([0,maxPPG + 5]).range([570,300]);
    return ppgScale;
  }

  function getAPGScale(maxAPG) {
    var apgScale = d3.scaleLinear().domain([0,maxAPG + 5]).range([570,300]);
    return apgScale;
  }

  function getRPGScale(maxRPG) {
    var rpgScale = d3.scaleLinear().domain([0,maxRPG + 5]).range([570,300]);
    return rpgScale;
  }

  function getBPGScale(maxBPG) {
    var bpgScale = d3.scaleLinear().domain([0,maxBPG]).range([570,300]);
    return bpgScale;
  }

  function getSPGScale(maxSPG) {
    var spgScale = d3.scaleLinear().domain([0,maxSPG]).range([570,300]);
    return spgScale;
  }

  function getPlusMinusScale(maxPL, minPL) {
    var plusminusScale = d3.scaleLinear().domain([minPL,maxPL]).range([570,300]);
    return plusminusScale;
  }

  function getOpacityScale(numberseasons) {
    var opacityScale = d3.scaleLinear().domain([0, numberseasons]).range([0, 1]);
    return opacityScale;
  }

  ppgScale = getPPGScale(maxPPG);
  apgScale = getAPGScale(maxAPG);
  rpgScale = getRPGScale(maxRPG);
  bpgScale = getBPGScale(maxBPG);
  spgScale = getSPGScale(maxSPG);
  plusminusScale = getPlusMinusScale(maxPL, minPL);
  opacityScale = getOpacityScale(bestplayers[index3].seasons.length);

  var labels = ['PPG', 'APG', 'RPG', 'BPG', 'SPG', '+/-'];

  var playoffLabels = ['Champion', 'Finals', 
  'Conference Finals', 'Conference Semifinals', '1st Round', 'No Playoffs'];

  var yearLabels = ['Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5', 'Year 6',
  'Year 7', 'Year 8', 'Year 9', 'Year 10', 'Year 11', 'Year 12', 'Year 13',
  'Year 14', 'Year 15', 'Year 16', 'Year 17', 'Year 18', 'Year 19', 'Year 20',
  'Year 21', 'Year 22', 'Year 23', 'Year 24', 'Year 25'];

  var xScale1 = d3.scaleOrdinal()
    .domain(labels)
    .range([0, 120, 240, 360, 480, 600]);

//overview line chart creation

  svg.append("text")             
      .attr("transform",
          "translate(350, 680)")
      .style("text-anchor", "middle")
      .style("font-family", "Helvetica, Arial, Sans-Serif")
      .style("font-size", "20px")
      .text("Playoff Results for Each Season")
      .attr("fill", "black");

  xScale3 = setupOverview(index3, index4);

  function setupOverview(index1, index2) {

      if(bestplayers[index2].seasons.length > bestplayers[index1].seasons.length) {

        var slicedArr = yearLabels.slice(0, bestplayers[index2].seasons.length);

        var xScale2 = d3.scaleBand()
          .domain(slicedArr)
          .range([0, width - 200]);

        var xScale3 = d3.scaleLinear()
          .domain([0, slicedArr.length])
          .range([0, width - 200]);

      svg.append("g")
        .attr("class", "x axis")
        .attr("id", "overview")
        .attr("transform", "translate(60, 1050)")
        .call(d3.axisBottom(xScale2));

      } else {

        var slicedArr = yearLabels.slice(0, bestplayers[index1].seasons.length);

        var xScale2 = d3.scaleBand()
          .domain(slicedArr)
          .range([0, width - 200]);

        var xScale3 = d3.scaleLinear()
          .domain([0, slicedArr.length])
          .range([0, width - 200]); 

        svg.append("g")
        .attr("class", "x axis")
        .attr("id", "overview")
        .attr("transform", "translate(60, 1050)")
        .call(d3.axisBottom(xScale2));

      }
      return xScale3;
  }

  var yScalePlayoffs = d3.scaleOrdinal()
    .domain(playoffLabels)
    .range([0, 60, 120, 180, 240, 300]);

  svg.append("g")
    .attr("class", "y axis")
    .attr("transform", "translate(60, 750)")
    .call(d3.axisLeft(yScalePlayoffs));

  createOverview(index3, "blue", "one", xScale3);
  createOverview(index4, "red", "two", xScale3);

  function getPlayerName(id) {
    if(id.includes("one")) {
      var playerNameInd = getIndex(d3.select('select#one').property('value'), bestplayers);
      var playerName = bestplayers[playerNameInd].name.replace("*", "");
    } else {
      var playerNameInd = getIndex(d3.select('select#two').property('value'), bestplayers);
      var playerName = bestplayers[playerNameInd].name.replace("*", "");
    }
    return playerName;
  }

  function getDivInfo(seasonObject, id) {
    var playerName = getPlayerName(id);
    var index = seasonObject.team.length;
    var info = "<font color='white'>" + "Player: " + playerName + "<br/>";
    info += "Team: " + seasonObject.team[index - 1] + "<br/>";
    info += "Player Age: " + seasonObject.age + "<br/>";
    info += "Series: " + seasonObject.playoffs[1] + " - " + seasonObject.playoffs[3] + 
    ", " + seasonObject.playoffs[2] + " - " + seasonObject.playoffs[4] + "</font>";
    return info;
  }

  function getPixels(id) {
    if(id.includes("one")) {
      return (d3.event.pageX - 220) + "px"; 
    } else {
      return (d3.event.pageX + 20) + "px";
    }
  }

  function getColor(id) {
    if(id.includes("one")) {
      return "DarkBlue";
    } else {
      return "DarkRed";
    }
  }

  function createOverview(index, color, which, xScale) {

    var line = d3.line()
      .x(function(d, i) { return xScale(i); })
      .y(function(d) { return getOverviewPos(d)});

    svg.append("path")
      .datum(bestplayers[index].seasons)
      .attr("id", which)
      .attr("class", "line")
      .attr("transform", "translate(81, 750)")
      .attr("d", line)
      .attr("stroke", color)
      .attr("stroke-width", 2)
      .attr("fill", "none");

    svg.selectAll(".dot" + which)
      .data(bestplayers[index].seasons)
      .enter().append("circle")
      .attr("id", function(d, i) { return 'circle_' + which + '_' + i})
      .attr("class", "dot")
      .attr("cx", function(d, i) { return xScale3(i); })
      .attr("cy", function(d) { return getOverviewPos(d); })
      .attr("transform", "translate(81, 750)")
      .attr("fill", color)
      .attr("r", 5)
      .on("mouseover", function(d) {  
        if(d.playoffs.length > 1) {  
            div.transition()    
                .duration(400)    
                .style("opacity", .9); 
            div.html(getDivInfo(d, this.id))
                .style("left", getPixels(this.id))   
                .style("top", (d3.event.pageY - 28) + "px")
                .style("background", getColor(this.id));
        } else {
            var index = d.team.length;
            var playerName = getPlayerName(this.id);
            var info = "<font color='white'>" + "Player: " + playerName;
            info += "Team: " + d.team[index - 1] + "<br/>";
            info += "Player Age: " + d.age + "<br/>" + "<br/>";
            info += "Did not make playoffs" + "</font>";
            div.transition()    
                .duration(400)    
                .style("opacity", .9); 
            div .html(info)
                .style("left", (d3.event.pageX) + "px")   
                .style("top", (d3.event.pageY - 28) + "px")
                .style("background", getColor(this.id));  
            }
        })     
        .on("mouseout", function(d) {   
            div.transition()    
                .duration(600)    
                .style("opacity", 0);
        });
    }

    function getOverviewPos(seasonObj) {

      if(seasonObj.playoffs == "No Playoffs") {
        return 300;
      }
      if(seasonObj.playoffs[0].includes("First Round")) {
        return 240;
      }
      if(seasonObj.playoffs[0].includes("Semifinals")) {
        return 180;
      }
      if(seasonObj.playoffs[0].includes("Conf") && seasonObj.playoffs[0].includes("Finals")) {
        return 120;
      }
      if(seasonObj.playoffs[0].includes("Div") && seasonObj.playoffs[0].includes("Finals")) {
        return 120;
      }
      if(seasonObj.playoffs[0] == "Finals") {
        return 60;
      }
      if(seasonObj.playoffs[0] == "Champion") {
        return 0;
      }
    }

  svg.append("g")
      .attr("id", "yone")
      .attr("class", "y axis")
      .attr("transform", "translate(60, 0)")
      .call(d3.axisLeft(getPPGScale(maxPPG)));

  svg.append("g")
      .attr("id", "ytwo")
      .attr("class", "y axis")
      .attr("transform", "translate(180, 0)")
      .call(d3.axisLeft(getAPGScale(maxAPG)));

  svg.append("g")
      .attr("id", "ythree")
      .attr("class", "y axis")
      .attr("transform", "translate(300, 0)")
      .call(d3.axisLeft(getRPGScale(maxRPG)));

  svg.append("g")
      .attr("id", "yfour")
      .attr("class", "y axis")
      .attr("transform", "translate(420, 0)")
      .call(d3.axisLeft(getBPGScale(maxBPG)));

  svg.append("g")
      .attr("id", "yfive")
      .attr("class", "y axis")
      .attr("transform", "translate(540, 0)")
      .call(d3.axisLeft(getSPGScale(maxSPG)));   

  svg.append("g")
      .attr("id", "ysix")
      .attr("class", "y axis")
      .attr("transform", "translate(660, 0)")
      .call(d3.axisLeft(getPlusMinusScale(maxPL, minPL)));

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(60, 585)")
      .call(d3.axisBottom(xScale1));

  var scales = [ppgScale, apgScale, rpgScale, bpgScale, spgScale, plusminusScale, opacityScale];

  drawLines(index3, "blue", "one", scales);
  scales[6] = getOpacityScale(bestplayers[index4].seasons.length);
  drawLines(index4, "red", "two", scales);
  drawLegend(d3.select('select#one').property('value'), d3.select('select#two').property('value'));

  function drawLines(index, color, numb, scales) {
    for(var r = 0 ; r < bestplayers[index].seasons.length ; r++) {
      var games = bestplayers[index].seasons[r].games;
      var ppg = bestplayers[index].seasons[r].points/games;
      var apg = bestplayers[index].seasons[r].assists/games;
      var rpg = bestplayers[index].seasons[r].rebounds/games;
      var bpg = bestplayers[index].seasons[r].blocks/games;
      var spg = bestplayers[index].seasons[r].steals/games;
      var plusminus = bestplayers[index].seasons[r].plusminus;

      drawLine(60, 180, color, r, ppg, apg, numb, scales);
      drawLine(180, 300, color, r, apg, rpg, numb, scales);
      drawLine(300, 420, color, r, rpg, bpg, numb, scales);
      drawLine(420, 540, color, r, bpg, spg, numb, scales);
      drawLine(540, 660, color, r, spg, plusminus, numb, scales);
    }
  }

  function drawLine(start, end, color, r, stat1, stat2, numb, scales) {
    var attrID = "line" + start + "_" + r.toString() + numb;
    ppgScale = scales[0];
    apgScale = scales[1];
    rpgScale = scales[2];
    bpgScale = scales[3];
    spgScale = scales[4];
    plusminusScale = scales[5];
    opacityScale = scales[6];

    if(start == 60) {
      var y1 = ppgScale(stat1);
      var y2 = apgScale(stat2);
    }
    if(start == 180) {
      var y1 = apgScale(stat1);
      var y2 = rpgScale(stat2);
    }
    if(start == 300) {
      var y1 = rpgScale(stat1);
      var y2 = bpgScale(stat2);
    } 
    if(start == 420) {
      var y1 = bpgScale(stat1);
      var y2 = spgScale(stat2);
    }
    if(start == 540) {
      var y1 = spgScale(stat1);
      var y2 = plusminusScale(stat2);
    }   

    svg.append("line")
      .attr("id", attrID)
      .attr("x1", start)
      .attr("y1", y1)
      .attr("x2", end)
      .attr("y2", y2)
      .attr("stroke-width", 1)
      .attr("stroke", color)
      .attr("opacity", function(d) { return opacityScale(r); });
  }

  function drawLegend(player1, player2) {
    svg.append("line")
      .attr("x1", 650) //-40
      .attr("y1", 180)
      .attr("x2", 650) //-40
      .attr("y2", 260)
      .attr("stroke-width", 3)
      .attr("stroke", "black");
    svg.append("line")
      .attr("x1", 815)
      .attr("y1", 180)
      .attr("x2", 815)
      .attr("y2", 260)
      .attr("stroke-width", 3)
      .attr("stroke", "black");
    svg.append("line")
      .attr("x1", 650)
      .attr("y1", 180)
      .attr("x2", 815)
      .attr("y2", 180)
      .attr("stroke-width", 3)
      .attr("stroke", "black");

    svg.append("line")
      .attr("x1", 650)
      .attr("y1", 259)
      .attr("x2", 815)
      .attr("y2", 259)
      .attr("stroke-width", 3)
      .attr("stroke", "black");

    svg.append("line")
      .attr("x1", 660)
      .attr("y1", 207)
      .attr("x2", 686)
      .attr("y2", 207)
      .attr("stroke-width", 5)
      .attr("stroke", "blue");

    svg.append("line")
      .attr("x1", 660)
      .attr("y1", 235)
      .attr("x2", 686)
      .attr("y2", 235)
      .attr("stroke-width", 5)
      .attr("stroke", "red");

    svg.append("text")   
      .attr("id", "legendone")          
      .attr("transform",
          "translate(735, 210)")
      .style("text-anchor", "middle")
      .style("font-size", "13px")
      .text(player1)
      .attr("fill", "black")
      .style("font-family", "Helvetica, Arial, Sans-Serif")
      .on("mouseover", function() {
        for(a = 0 ; a < 600 ; a++) {
          for(r = 0 ; r < 20 ; r++) {
            d3.select('#line' + a + "_" + r + "two").style("opacity", 0);
          }
        }
      })
      .on("mouseout", function() {
        for(a = 0 ; a < 600 ; a++) {
          for(r = 0 ; r < 20 ; r++) {
            d3.select('#line' + a + "_" + r + "two").style("opacity", function(d) { return opacityScale(r); });
          }
        }
      });

    svg.append("text")  
      .attr("id", "legendtwo")          
      .attr("transform",
          "translate(735, 238)")
      .style("text-anchor", "middle")
      .style("font-size", "13px")
      .text(player2)
      .attr("fill", "black")
      .style("font-family", "Helvetica, Arial, Sans-Serif")
      .on("mouseover", function() {
        for(a = 0 ; a < 600 ; a++) {
          for(r = 0 ; r < 20 ; r++) {
            d3.select('#line' + a + "_" + r + "one").style("opacity", 0);
          }
        }
      })
      .on("mouseout", function() {
        for(a = 0 ; a < 600 ; a++) {
          for(r = 0 ; r < 20 ; r++) {
            d3.select('#line' + a + "_" + r + "one").style("opacity", function(d) { return opacityScale(r); });
          }
        }
      });

    svg.append("text")            
      .attr("transform",
          "translate(730, 170)")
      .style("text-anchor", "middle")
      .style("font-size", "14px")
      .text("Legend")
      .style("font-family", "Helvetica, Arial, Sans-Serif")
      .attr("fill", "black");
  }

  function onchange1() {
    selectValue = d3.select('select#one').property('value');
    selectValueOther = d3.select('select#two').property('value');
    d3.select('image#pic_one').attr("xlink:href", "playerpictures/" + formatName(selectValue));
    d3.select('text#text_one').text(selectValue);
    d3.select('text#legendone').text(selectValue);
    for(a = 0 ; a < 600 ; a++) {
      for(r = 0 ; r < 20 ; r++) {
        d3.select('#line' + a + "_" + r + "one").remove();
      }
    }
    for(a = 0 ; a < 600 ; a++) {
      for(r = 0 ; r < 20 ; r++) {
        d3.select('#line' + a + "_" + r + "two").remove();
      }
    }
    d3.select('#yone').remove();
    d3.select('#ytwo').remove();
    d3.select('#ythree').remove();
    d3.select('#yfour').remove();
    d3.select('#yfive').remove();
    d3.select('#ysix').remove();

    console.log(d3.select('#circle_' + 'one' + '_' + 3));
    for(k = 0 ; k < 25 ; k++) {
      d3.select('#circle_' + 'one' + '_' + k).remove();
      d3.select('#circle_' + 'two' + '_' + k).remove();
    }

    d3.select('path#' + 'one').remove();
    d3.select('path#' + 'two').remove();
    d3.select('#overview').remove();
    
    var index1 = getIndex(selectValue, bestplayers);
    var index2 = getIndex(selectValueOther, bestplayers);
    var maxPPG = getMax(0, bestplayers[index1].seasons, bestplayers[index2].seasons);
    var maxAPG = getMax(1, bestplayers[index1].seasons, bestplayers[index2].seasons);
    var maxRPG = getMax(2, bestplayers[index1].seasons, bestplayers[index2].seasons);
    var maxBPG = getMax(3, bestplayers[index1].seasons, bestplayers[index2].seasons);
    var maxSPG = getMax(4, bestplayers[index1].seasons, bestplayers[index2].seasons);
    var maxPL = getMax(5, bestplayers[index1].seasons, bestplayers[index2].seasons);
    var minPL = getMinPL(bestplayers[index1].seasons, bestplayers[index2].seasons);

    ppgScale = getPPGScale(maxPPG);
    apgScale = getAPGScale(maxAPG);
    rpgScale = getRPGScale(maxRPG);
    bpgScale = getBPGScale(maxBPG);
    spgScale = getSPGScale(maxSPG)
    plusminusScale = getPlusMinusScale(maxPL, minPL);
    opacityScale = getOpacityScale(bestplayers[index1].seasons.length);

    var scales = [ppgScale, apgScale, rpgScale, bpgScale, spgScale, plusminusScale, opacityScale];

    drawAxes(scales);

    drawLines(index1, "blue", "one", scales);

    scales[6] = getOpacityScale(bestplayers[index2].seasons.length);
    drawLines(index2, "red", "two", scales);

    xScale3 = setupOverview(index1, index2);

    createOverview(index1, "blue", "one", xScale3);
    createOverview(index2, "red", "two", xScale3);
  };

  function onchange2() {
    selectValue = d3.select('select#two').property('value')
    selectValueOther = d3.select('select#one').property('value');
    d3.select('image#pic_two').attr("xlink:href", "playerpictures/" + formatName(selectValue));
    d3.select('text#text_two').text(selectValue);
    d3.select('text#legendtwo').text(selectValue);
    for(a = 0 ; a < 600 ; a++) {
      for(r = 0 ; r < 20 ; r++) {
        d3.select('#line' + a + "_" + r + "one").remove();
        d3.select('#circle_' + 'one' + '_' + r)
      }
    }
    for(a = 0 ; a < 600 ; a++) {
      for(r = 0 ; r < 20 ; r++) {
        d3.select('#line' + a + "_" + r + "two").remove();
      }
    }
    d3.select('#yone').remove();
    d3.select('#ytwo').remove();
    d3.select('#ythree').remove();
    d3.select('#yfour').remove();
    d3.select('#yfive').remove();
    d3.select('#ysix').remove();

    for(k = 0 ; k < 25 ; k++) {
      d3.select('#circle_' + 'one' + '_' + k).remove();
      d3.select('#circle_' + 'two' + '_' + k).remove();
    }

    d3.select('path#' + 'one').remove();
    d3.select('path#' + 'two').remove();
    d3.select('#overview').remove();

    var index2 = getIndex(selectValue, bestplayers);
    var index1 = getIndex(selectValueOther, bestplayers);
    var maxPPG = getMax(0, bestplayers[index1].seasons, bestplayers[index2].seasons);
    var maxAPG = getMax(1, bestplayers[index1].seasons, bestplayers[index2].seasons);
    var maxRPG = getMax(2, bestplayers[index1].seasons, bestplayers[index2].seasons);
    var maxBPG = getMax(3, bestplayers[index1].seasons, bestplayers[index2].seasons);
    var maxSPG = getMax(4, bestplayers[index1].seasons, bestplayers[index2].seasons);
    var maxPL = getMax(5, bestplayers[index1].seasons, bestplayers[index2].seasons);
    var minPL = getMinPL(bestplayers[index1].seasons, bestplayers[index2].seasons);

    ppgScale = getPPGScale(maxPPG);
    apgScale = getAPGScale(maxAPG);
    rpgScale = getRPGScale(maxRPG);
    bpgScale = getBPGScale(maxBPG);
    spgScale = getSPGScale(maxSPG)
    plusminusScale = getPlusMinusScale(maxPL, minPL);
    opacityScale = getOpacityScale(bestplayers[index1].seasons.length);

    var scales = [ppgScale, apgScale, rpgScale, bpgScale, spgScale, plusminusScale, opacityScale];

    drawAxes(scales);

    drawLines(index2, "red", "two", scales);
    scales[6] = getOpacityScale(bestplayers[index2].seasons.length);
    drawLines(index1, "blue", "one", scales);
    xScale3 = setupOverview(index1, index2);

    createOverview(index1, "blue", "one", xScale3);
    createOverview(index2, "red", "two", xScale3);
  };

  function drawAxes(scales) {
    svg.append("g")
      .attr("id", "yone")
      .attr("class", "y axis")
      .attr("transform", "translate(60, 0)")
      .call(d3.axisLeft(scales[0]));

    svg.append("g")
      .attr("id", "ytwo")
      .attr("class", "y axis")
      .attr("transform", "translate(180, 0)")
      .call(d3.axisLeft(scales[1]));

    svg.append("g")
      .attr("id", "ythree")
      .attr("class", "y axis")
      .attr("transform", "translate(300, 0)")
      .call(d3.axisLeft(scales[2]));

    svg.append("g")
      .attr("id", "yfour")
      .attr("class", "y axis")
      .attr("transform", "translate(420, 0)")
      .call(d3.axisLeft(scales[3]));

    svg.append("g")
      .attr("id", "yfive")
      .attr("class", "y axis")
      .attr("transform", "translate(540, 0)")
      .call(d3.axisLeft(scales[4]));   

    svg.append("g")
      .attr("id", "ysix")
      .attr("class", "y axis")
      .attr("transform", "translate(660, 0)")
      .call(d3.axisLeft(scales[5]));
  }

});


</script>

  </body>
</html>
